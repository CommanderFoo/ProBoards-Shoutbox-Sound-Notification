"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Shoutbox_Sound_Notification=function(){function Shoutbox_Sound_Notification(){_classCallCheck(this,Shoutbox_Sound_Notification)}_createClass(Shoutbox_Sound_Notification,null,[{key:"init",value:function init(){this.PLUGIN_ID="pd_shoutbox_notification_sound";this.audio_string="";this.setup();if(this.audio_string.length>0){this.audio=new Audio(this.audio_string);$(this.ready.bind(this))}}},{key:"ready",value:function ready(){this.monitor_shoutbox()}},{key:"setup",value:function setup(){var plugin=pb.plugin.get(this.PLUGIN_ID);if(plugin&&plugin.settings){var settings=plugin.settings;if(settings.base64_string.length>0){this.audio_string="data:audio/mpeg;base64,"+settings.base64_string}}}},{key:"monitor_shoutbox",value:function monitor_shoutbox(){$.ajaxPrefilter(function(opts,orig_opts){if(orig_opts.url==proboards.data("shoutbox_update_url")){var orig_success=orig_opts.success;opts.success=function(e){orig_success(e);Shoutbox_Sound_Notification.check_shout(e)}}})}},{key:"check_shout",value:function check_shout(data){if(data&&data.new_ids&&data.new_ids.length>0){var user_id=parseInt(pb.data("user").id,10);var $last_shout=$(".shoutbox-post:last");if($last_shout.length==1){var $last_user_id=$last_shout.find("a.user-link:first");if($last_user_id.length==1){if(parseInt($last_user_id.attr("data-id"),10)!=user_id){this.play_notification()}}}}}},{key:"play_notification",value:function play_notification(){this.audio.play()}}]);return Shoutbox_Sound_Notification}();Shoutbox_Sound_Notification.init();